<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <!-- Bootstrap -->
    <link href="http://cdn.bootcss.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="__JS__/bootstrap-datatable/css/jquery.bdt.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="http://v3.bootcss.com/examples/dashboard/dashboard.css" rel="stylesheet">
    <link rel="stylesheet" href="//rawgit.com/vitalets/x-editable/master/dist/bootstrap3-editable/css/bootstrap-editable.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
  <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.js"></script>
  <script src="http://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">后台管理框架</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#">Dashboard</a></li>
                    <li><a href="#">Settings</a></li>
                    <li><a href="#">Profile</a></li>
                    <li><a href="#">Help</a></li>
                </ul>
                <form class="navbar-form navbar-right">
                    <input type="text" class="form-control" placeholder="Search...">
                </form>
            </div>
        </div>
    </nav>
    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-3 col-md-2 sidebar">
                <if condition="$MenuList">
                    <foreach name="MenuList" item="vo">
                        <ul class="nav nav-sidebar">
                            <li><a href="{:U($vo['menu_url'])}">{$vo.name}</a></li>
                            <!-- <li><a href="#">Reports</a></li>
                <li><a href="#">Analytics</a></li>
                <li><a href="#">Export</a></li> -->
                        </ul>
                        <!-- <ul class="nav nav-sidebar">
            <li><a href="">菜单管理</a></li>
            <li><a href="">Nav item again</a></li>
            <li><a href="">One more nav</a></li>
            <li><a href="">Another nav item</a></li>
            <li><a href="">More navigation</a></li>
          </ul> -->
                    </foreach>
                </if>
            </div>
            <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
                <!-- <h1 class="page-header">控制面板</h1> -->
                <ol class="breadcrumb">
                    <li><a href="#">Home</a></li>
                    <li class="active">菜单管理</li>
                </ol>
                <h2 class="sub-header">菜单管理</h2>
                <div class="panel panel-default">
                    <div class="panel-heading">查询条件</div>
                    <div class="panel-body">
                        <form id="formSearch" class="form-horizontal">
                            <div class="form-group" style="margin-top:15px">
                                <label class="control-label col-sm-1" for="txt_search_departmentname">菜单名称</label>
                                <div class="col-sm-3">
                                    <input type="text" class="form-control" id="txt_search_name">
                                </div>
                                <label class="control-label col-sm-1" for="txt_search_status">状态</label>
                                <div class="col-sm-3">
                                    <input type="text" class="form-control" id="txt_search_status">
                                </div>
                                <div class="col-sm-4" style="text-align:left;">
                                    <button type="button" style="margin-left:50px" id="btn_query" class="btn btn-primary">查询</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
                <div id="toolbar" class="btn-group">
                    <button id="btn_add" type="button" class="btn btn-default" data-toggle="modal" data-target="#myModal">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>新增
                    </button>
                    <!-- Modal -->
                    <!-- <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                    <h4 class="modal-title" id="myModalLabel">添加菜单</h4>
                                </div>
                                <div class="modal-body">
                                    <form id="form-member-add" action="" method="POST">
                                        <div class="input-group">
                                            <div class="col-md-3" style="text-align: right">
                                                <label>菜单名称：</label>
                                            </div>
                                            <div class="col-md-8">
                                                <input type="text" name="name" class="form-control" placeholder="菜单名称">
                                            </div>
                                        </div>
                                        <div class="input-group">
                                            <div class="col-md-3" style="text-align: right">
                                                <label>菜单路径：</label>
                                            </div>
                                            <div class="col-md-8">
                                                <input type="text" name="menuurl" class="form-control" placeholder="菜单路径">
                                            </div>
                                        </div>
                                        <div class="input-group">
                                            <div class="col-md-4" style="text-align: right">
                                                <label>菜单等级：</label>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="dropdown">
                                                    <a href="##" class="dropdown-toggle" id="dLabel"></a>
                                                </div>
                                                <input type="hidden" id="levelVal" value="">
                                            </div>
                                        </div>
                                    </form>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                                    <button type="button" class="btn btn-primary" id="save">保存</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div> -->
                </div>
                <div class="row-fluid">
                    <table class="table table-striped table-bordered table-hover datatable" id="bootstrap-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>菜单名称</th>
                                <th>菜单路径</th>
                                <th>菜单级别</th>
                                <th>是否隐藏</th>
                            </tr>
                        </thead>
                        <tbody>                         
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
</body>
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="__JS__/bootstrap-dropdownlist.js"></script>
<!-- <script src="__JS__/bootstrap-datatable/js/jquery.bdt.min.js"></script> -->
<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/bootstrap-table.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.0/locale/bootstrap-table-zh-CN.min.js"></script>
<!-- <script src="//rawgit.com/vitalets/x-editable/master/dist/bootstrap3-editable/js/bootstrap-editable.js"></script> -->
<!-- <script src="~/Content/bootstrap-table/extensions/editable/bootstrap-table-editable.js"></script> -->
<script type="text/javascript">
var url = "{:U('Home/Menu/add')}";
var queryParams = function(params) {
    var temp = { //这里的键的名字和控制器的变量名必须一直，这边改动，控制器也需要改成一样的
        limit: params.limit, //页面大小
        offset: params.offset, //页码
        name: $("#txt_search_name").val(),
        status: $("#txt_search_status").val()
    };
    return temp;
};
$(function() {
    $("#dLabel").DropDownList({
        InputName: "level",
        ButtonText: "请选择",
        MaxHeight: 310,
        onSelect: function(I, Data) {
            // ShowData(I,Data);
            $("#levelVal").val(Data);
        },
        Items: [{
            ItemText: "根节点",
            ItemData: "0",
            Selected: true
        }, {
            ItemText: "一级菜单",
            ItemData: "1"
        }, {
            ItemText: "二级菜单",
            ItemData: "2"
        }, {
            ItemText: "三级菜单",
            ItemData: "3"
        }]
    });

    initTable();
    add();

    // $('#bootstrap-table').bdt({
    //     showSearchForm: 1,
    //     pageFieldText: '记录/页'
    // });

})

function initTable() {
    $("#bootstrap-table").bootstrapTable({
        url: url,
        method: 'get',
        toolbar: '#toolbar',
        pagination: true,
        pageNumber: 1,
        pageSize: 10,
        queryParams: queryParams,
        sidePagination: "server",
        onEditableSave: function(field, row) {
            window.alert(JSON.stringify(row));
        },
        columns: [{
            field: 'name',
            title: '菜单名称'
        }, {
            field: 'menu_url',
            title: '菜单路径'
        }, {
            field: 'level',
            title: '菜单级别'
        }
        // , {
        //     field: 'Desc',
        //     title: '描述'
        // }
        ]
    })
}

function add() {
    $("#save").bind("click", function() {
        // alert($("#form-member-add").serialize());
        if (validate() != true) {
            return;
        }
        $.ajax({
            type: 'POST',
            url: url,
            data: $("#form-member-add").serialize(),
            dataType: 'json',
            success: function(data) {
                console.log(data);
            }
        })
    })
}

function ShowData(InputName, Data) {
    alert(InputName + ":" + Data);
}

function validate() {
    var name = $.trim($("input[name='name']").val());
    var url = $.trim($("input[name='menuurl']").val())
    if (name == '' || name == null) {
        alert('请输入菜单名');
        return false;
    }
    if (url == '' || url == null) {
        alert('请输入菜单路径');
        return false;
    }
    return true;
}
</script>

</html>
